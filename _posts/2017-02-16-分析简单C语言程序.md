---
layout: post
title: '通过汇编一个简单的C程序，分析汇编代码理解计算机工作原理'
date: '2017-02-16'
header-img: "img/home-bg.jpg"
tags:
     - linux
author: 'De4dCr0w'
---

## 版权声明：本文为博主原创文章，未经博主允许不得转载。
罗军 + 原创作品转载请注明出处 + 《Linux内核分析》MOOC课程http://mooc.study.163.com/course/USTC-1000029000
## 源程序

int g(int x)
{
    return x+5;
}

int f(int x)
{
    return g(x);
}

int main(void)
{
    return f(7)+2;
}

### 编译命令
```
 gcc -S -o main.s main.c -m32
```
将原程序编译成汇编指令，其中-m32是将其编译成32位下的汇编。
将汇编文件中用于链接过程的代码删除，得到下面汇编代码
###汇编代码
```
1 g:
2	pushl	%ebp
3	movl	%esp, %ebp
4	movl	8(%ebp), %eax
5	addl	$5, %eax
6	popl	%ebp
7	ret
8 f:
9	pushl	%ebp
10	movl	%esp, %ebp
11	subl	$4, %esp
12	movl	8(%ebp), %eax
13	movl	%eax, (%esp)
14	call	g
15	leave
16	ret
17 main:
18	pushl	%ebp
19	movl	%esp, %ebp
20	subl	$4, %esp
21	movl	$7, (%esp)
22	call	f
23	addl	$2, %eax
24	leave
25	ret
```

### 分析汇编程序
